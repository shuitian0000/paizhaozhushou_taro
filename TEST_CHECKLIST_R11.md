# 第十一轮优化功能测试清单

## 测试环境
- 真机测试（必须）
- 微信小程序环境
- 需要相机权限和相册权限

## 新增功能测试

### 1. 保存到手机相册功能

#### 测试步骤
1. 进入拍照助手页面
2. 点击"开始实时评估"或"直接拍摄"
3. 拍摄一张照片
4. 点击"确认拍摄"
5. 点击"保存评估结果"

#### 预期结果
- ✅ 显示"保存中..."加载提示
- ✅ 照片保存到手机相册
- ✅ 照片上传到云端
- ✅ 评估记录保存到数据库
- ✅ 显示"保存成功"提示
- ✅ 跳转到结果详情页

#### 权限测试
**场景1：首次使用，未授权相册权限**
- ✅ 弹出权限请求对话框
- ✅ 用户拒绝后，显示"需要相册权限"提示
- ✅ 提供"去设置"按钮
- ✅ 点击后跳转到小程序设置页

**场景2：已授权相册权限**
- ✅ 直接保存到相册
- ✅ 无需再次请求权限

**场景3：权限被禁用**
- ✅ 显示友好的错误提示
- ✅ 引导用户开启权限

### 2. 直接拍摄功能

#### 测试步骤
1. 进入拍照助手页面
2. 观察底部按钮布局
3. 点击"直接拍摄"按钮

#### 预期结果
- ✅ 看到两个按钮："开始实时评估"和"直接拍摄"
- ✅ "直接拍摄"按钮样式清晰可见
- ✅ 点击后显示"拍摄中..."加载提示
- ✅ 自动拍摄一张照片（无需手动操作）
- ✅ 立即进行评估
- ✅ 显示评估结果页面
- ✅ 不启动实时评估定时器

#### 对比测试
**直接拍摄 vs 实时评估**
| 功能 | 直接拍摄 | 实时评估 |
|------|---------|---------|
| 拍照次数 | 1次 | 每2秒1次 |
| 实时建议 | 无 | 有 |
| 评估计数 | 无 | 有 |
| 用户操作 | 点击1次 | 点击开始+确认 |
| 使用场景 | 快速拍照 | 调整构图 |

### 3. 实时建议UI优化

#### 测试步骤
1. 进入拍照助手页面
2. 点击"开始实时评估"
3. 观察实时建议的显示效果

#### 预期结果
**视觉效果**：
- ✅ 背景色：黑色半透明（bg-black/80）
- ✅ 边框：2px主题色边框（border-2 border-primary/50）
- ✅ 圆角：更大的圆角（rounded-2xl）
- ✅ 内边距：更大的内边距（p-5）

**图标和标题**：
- ✅ 灯泡图标：更大（text-2xl）
- ✅ 标题文字：更大更粗（text-base font-bold）
- ✅ 图标颜色：主题色（text-primary）

**建议内容**：
- ✅ 使用箭头图标（i-mdi-chevron-right）
- ✅ 文字更大（text-base）
- ✅ 文字加粗（font-medium）
- ✅ 行高适中（leading-relaxed）
- ✅ 每条建议独立一行

**对比效果**：
| 项目 | 旧版 | 新版 |
|------|------|------|
| 背景透明度 | 70% | 80% |
| 边框 | 无 | 2px主题色 |
| 圆角 | rounded-xl | rounded-2xl |
| 图标大小 | text-lg | text-2xl |
| 标题大小 | text-sm | text-base |
| 内容大小 | text-sm | text-base |
| 内容粗细 | normal | font-medium |

### 4. 评估算法优化

#### 测试场景1：人像照片
**拍摄内容**：人物特写或半身照

**预期评估**：
- ✅ 场景类型识别为'portrait'
- ✅ 构图建议关注主体位置
- ✅ 角度建议关注人物角度
- ✅ 光线建议关注肤色还原
- ✅ 评分考虑中心焦点（主体突出）

**测试建议示例**：
- 低分：'主体不够突出，建议调整构图使主体更加清晰明确'
- 中分：'构图基础良好，可以尝试调整主体位置使其更符合黄金分割比例'
- 高分：'构图优秀，画面平衡感强，继续保持'

#### 测试场景2：风景照片
**拍摄内容**：自然风光、城市景观

**预期评估**：
- ✅ 场景类型识别为'landscape'
- ✅ 构图建议关注三分法
- ✅ 角度建议关注层次感
- ✅ 光线建议关注色彩表现
- ✅ 评分考虑构图分散度

**测试建议示例**：
- 低分：'建议使用三分法构图，将主体放在画面的交叉点上，使画面更有视觉冲击力'
- 中分：'画面细节略显不足，可以靠近主体或选择更丰富的场景'
- 高分：'构图优秀，画面平衡感强，继续保持'

#### 测试场景3：合影照片
**拍摄内容**：多人合照

**预期评估**：
- ✅ 场景类型识别为'group'
- ✅ 构图建议关注人物排列
- ✅ 角度建议关注包容性
- ✅ 光线建议关注均匀性
- ✅ 评分考虑平衡感

#### 测试场景4：不同光线条件

**场景4.1：光线充足**
- ✅ 亮度分数：8-10分
- ✅ 建议：'光线运用良好，明暗过渡自然'

**场景4.2：光线不足**
- ✅ 亮度分数：4-6分
- ✅ 建议：'画面整体偏暗，建议增加光源或提高ISO/曝光补偿'

**场景4.3：过度曝光**
- ✅ 亮度分数：4-6分
- ✅ 建议：'画面过度曝光，建议降低曝光或选择光线较柔和的时段拍摄'

**场景4.4：高光溢出**
- ✅ 亮度分数：4-6分
- ✅ 建议：'高光溢出严重，建议降低曝光或使用渐变滤镜'

**场景4.5：暗部丢失**
- ✅ 亮度分数：4-6分
- ✅ 建议：'暗部细节丢失严重，建议使用补光或HDR模式'

#### 测试场景5：不同构图质量

**场景5.1：优秀构图**
- ✅ 构图分数：24-30分
- ✅ 建议：'构图优秀，画面平衡感强，继续保持'

**场景5.2：良好构图**
- ✅ 构图分数：18-24分
- ✅ 建议：'构图基础良好，可以尝试调整主体位置使其更符合黄金分割比例'

**场景5.3：一般构图**
- ✅ 构图分数：< 18分
- ✅ 建议：'建议使用三分法构图，将主体放在画面的交叉点上，使画面更有视觉冲击力'

### 5. 评分区分度测试

#### 测试方法
拍摄5张不同质量的照片，观察评分分布

**照片1：专业级**
- 构图优秀、光线完美、角度独特
- 预期总分：85-95分

**照片2：良好级**
- 构图良好、光线适中、角度合理
- 预期总分：70-84分

**照片3：一般级**
- 构图平淡、光线一般、角度常规
- 预期总分：55-69分

**照片4：较差级**
- 构图混乱、光线不足、角度不当
- 预期总分：40-54分

**照片5：很差级**
- 多个维度都有明显问题
- 预期总分：< 40分

#### 预期结果
- ✅ 评分分布合理
- ✅ 不同质量照片得分差异明显
- ✅ 评分与实际质量相符
- ✅ 建议针对性强

## 性能测试

### 1. 评估速度测试
**测试方法**：
1. 开始实时评估
2. 观察每次评估的耗时
3. 记录10次评估的平均耗时

**预期结果**：
- ✅ 单次评估耗时：< 500ms
- ✅ 不影响实时性
- ✅ 界面流畅无卡顿

### 2. 内存占用测试
**测试方法**：
1. 开始实时评估
2. 持续评估2分钟（约60次）
3. 观察内存占用变化

**预期结果**：
- ✅ 内存占用稳定
- ✅ 无内存泄漏
- ✅ 应用不崩溃

## 兼容性测试

### 1. 不同机型测试
- iPhone（iOS）
- Android（不同品牌）

### 2. 不同微信版本
- 最新版本
- 较旧版本（如果可能）

## 回归测试

### 1. 原有功能测试
- ✅ 实时评估功能正常
- ✅ 照片评估功能正常
- ✅ 历史记录功能正常
- ✅ 结果详情功能正常

### 2. 数据库操作测试
- ✅ 评估记录保存正常
- ✅ 历史记录查询正常
- ✅ 照片上传正常

## 测试总结

### 必须通过的测试
1. ✅ 保存到相册功能正常
2. ✅ 直接拍摄功能正常
3. ✅ 实时建议UI醒目清晰
4. ✅ 评估算法准确专业
5. ✅ 评分区分度明显
6. ✅ 性能满足实时要求

### 可选优化项
- 进一步优化评估速度
- 增加更多场景识别
- 优化建议文案
- 增加评分解释

## 已知问题
- supabase.ts的process错误（可忽略，不影响功能）

## 测试结论
如果以上测试全部通过，则本轮优化成功！
